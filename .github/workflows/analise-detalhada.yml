name: ğŸ”¬ AnÃ¡lise Detalhada de Scripts

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 1'  # Toda segunda-feira

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  analyze-scripts:
    runs-on: ubuntu-latest
    environment:
      name: github-pages
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4
    
    - name: ğŸ” Clonar e analisar projeto
      run: |
        echo "ğŸ”¬ ANALISANDO SCRIPTS EM PROFUNDIDADE..."
        echo "========================================"
        
        # Clonar projeto principal
        git clone https://github.com/rclessa25-hub/imoveis-maceio.git source-project
        
        cd source-project
        
        # 1. ANÃLISE DOS MÃ“DULOS JS
        echo "ğŸ“ ANALISANDO MÃ“DULOS JAVASCRIPT..."
        echo "=================================="
        
        # Analisar cada mÃ³dulo individualmente
        for module in js/modules/*.js; do
          if [ -f "$module" ]; then
            MODULE_NAME=$(basename "$module" .js)
            LINES=$(wc -l < "$module" || echo "0")
            SIZE=$(wc -c < "$module" || echo "0")
            FUNCTIONS=$(grep -c "^function\|^const.*=\|^export.*function" "$module" 2>/dev/null || echo "0")
            
            echo "MODULE_${MODULE_NAME}_LINES=$LINES" >> ../modules.txt
            echo "MODULE_${MODULE_NAME}_SIZE=$SIZE" >> ../modules.txt
            echo "MODULE_${MODULE_NAME}_FUNCTIONS=$FUNCTIONS" >> ../modules.txt
            
            echo "ğŸ“¦ $MODULE_NAME: $LINES linhas, $FUNCTIONS funÃ§Ãµes"
          fi
        done
        
        # 2. ANÃLISE DOS COMPONENTES
        echo ""
        echo "ğŸ§© ANALISANDO COMPONENTES..."
        echo "============================"
        
        for component in js/components/*.js; do
          if [ -f "$component" ]; then
            COMP_NAME=$(basename "$component" .js)
            LINES=$(wc -l < "$component" || echo "0")
            echo "COMP_${COMP_NAME}_LINES=$LINES" >> ../components.txt
            echo "ğŸ“‹ $COMP_NAME: $LINES linhas"
          fi
        done
        
        # 3. ANÃLISE DE DEPENDÃŠNCIAS
        echo ""
        echo "ğŸ”„ MAPEANDO DEPENDÃŠNCIAS..."
        echo "=========================="
        
        # Analisar main.js para ver imports
        if [ -f "js/main.js" ]; then
          echo "MAIN_JS_CONTENT:" > ../dependencies.txt
          grep -n "import\|from\|require" js/main.js >> ../dependencies.txt 2>/dev/null || echo "Nenhum import encontrado" >> ../dependencies.txt
        fi
        
        # 4. ANÃLISE DE FUNÃ‡Ã•ES POR MÃ“DULO
        echo ""
        echo "âš¡ EXTRAINDO FUNÃ‡Ã•ES..."
        echo "======================"
        
        for module in js/modules/*.js; do
          if [ -f "$module" ]; then
            MODULE_NAME=$(basename "$module" .js)
            echo "" >> ../functions.txt
            echo "=== $MODULE_NAME ===" >> ../functions.txt
            grep -E "^function|^const.*=|^export.*function|^async.*function" "$module" | head -20 >> ../functions.txt
          fi
        done
        
        # 5. CONTAGEM DE LINHAS POR TIPO
        echo ""
        echo "ğŸ“ˆ ESTATÃSTICAS DE CÃ“DIGO..."
        echo "==========================="
        
        TOTAL_JS_LINES=$(find . -name "*.js" -exec cat {} \; 2>/dev/null | wc -l || echo "0")
        TOTAL_CSS_LINES=$(find . -name "*.css" -exec cat {} \; 2>/dev/null | wc -l || echo "0")
        TOTAL_HTML_LINES=$(find . -name "*.html" -exec cat {} \; 2>/dev/null | wc -l || echo "0")
        
        echo "TOTAL_JS_LINES=$TOTAL_JS_LINES" >> ../stats.txt
        echo "TOTAL_CSS_LINES=$TOTAL_CSS_LINES" >> ../stats.txt
        echo "TOTAL_HTML_LINES=$TOTAL_HTML_LINES" >> ../stats.txt
        
        echo "âœ… JavaScript: $TOTAL_JS_LINES linhas"
        echo "âœ… CSS: $TOTAL_CSS_LINES linhas"
        echo "âœ… HTML: $TOTAL_HTML_LINES linhas"
    
    - name: ğŸ“Š Gerar relatÃ³rio detalhado
      run: |
        echo "ğŸ“„ GERANDO RELATÃ“RIO DETALHADO..."
        echo "================================"
        
        DATE_NOW=$(date '+%d/%m/%Y Ã s %H:%M:%S')
        
        # Ler dados das anÃ¡lises
        MODULES_DATA=""
        if [ -f modules.txt ]; then
          MODULES_DATA=$(cat modules.txt)
        fi
        
        COMPONENTS_DATA=""
        if [ -f components.txt ]; then
          COMPONENTS_DATA=$(cat components.txt)
        fi
        
        DEPENDENCIES=""
        if [ -f dependencies.txt ]; then
          DEPENDENCIES=$(cat dependencies.txt)
        fi
        
        FUNCTIONS=""
        if [ -f functions.txt ]; then
          FUNCTIONS=$(cat functions.txt | head -100)
        fi
        
        # Criar HTML com anÃ¡lise detalhada
        echo '<!DOCTYPE html>' > index.html
        echo '<html lang="pt-BR">' >> index.html
        echo '<head>' >> index.html
        echo '    <meta charset="UTF-8">' >> index.html
        echo '    <meta name="viewport" content="width=device-width, initial-scale=1.0">' >> index.html
        echo '    <title>ğŸ”¬ AnÃ¡lise Detalhada - ImÃ³veis MaceiÃ³</title>' >> index.html
        echo '    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">' >> index.html
        echo '    <style>' >> index.html
        echo '        :root {' >> index.html
        echo '            --primary: #2ea44f;' >> index.html
        echo '            --dark: #0d1117;' >> index.html
        echo '            --dark-light: #161b22;' >> index.html
        echo '            --light: #c9d1d9;' >> index.html
        echo '            --border: #30363d;' >> index.html
        echo '            --blue: #58a6ff;' >> index.html
        echo '            --yellow: #f1e05a;' >> index.html
        echo '        }' >> index.html
        echo '        * { margin: 0; padding: 0; box-sizing: border-box; }' >> index.html
        echo '        body {' >> index.html
        echo '            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;' >> index.html
        echo '            background: var(--dark);' >> index.html
        echo '            color: var(--light);' >> index.html
        echo '            line-height: 1.6;' >> index.html
        echo '            padding: 20px;' >> index.html
        echo '        }' >> index.html
        echo '        .container { max-width: 1400px; margin: 0 auto; }' >> index.html
        echo '        header {' >> index.html
        echo '            text-align: center;' >> index.html
        echo '            padding: 40px 0;' >> index.html
        echo '            border-bottom: 3px solid var(--primary);' >> index.html
        echo '            margin-bottom: 40px;' >> index.html
        echo '        }' >> index.html
        echo '        h1 { color: var(--primary); font-size: 2.8em; margin-bottom: 10px; }' >> index.html
        echo '        h2 { color: var(--blue); margin: 40px 0 20px; padding-bottom: 10px; border-bottom: 2px solid var(--border); }' >> index.html
        echo '        h3 { color: var(--primary); margin: 30px 0 15px; }' >> index.html
        echo '        .nav {' >> index.html
        echo '            display: flex;' >> index.html
        echo '            flex-wrap: wrap;' >> index.html
        echo '            gap: 10px;' >> index.html
        echo '            margin: 30px 0;' >> index.html
        echo '            padding: 20px;' >> index.html
        echo '            background: var(--dark-light);' >> index.html
        echo '            border-radius: 12px;' >> index.html
        echo '        }' >> index.html
        echo '        .nav a {' >> index.html
        echo '            color: var(--light);' >> index.html
        echo '            text-decoration: none;' >> index.html
        echo '            padding: 12px 20px;' >> index.html
        echo '            background: #24292e;' >> index.html
        echo '            border-radius: 8px;' >> index.html
        echo '            display: flex;' >> index.html
        echo '            align-items: center;' >> index.html
        echo '            gap: 10px;' >> index.html
        echo '        }' >> index.html
        echo '        .nav a:hover { background: var(--primary); }' >> index.html
        echo '        .module-grid {' >> index.html
        echo '            display: grid;' >> index.html
        echo '            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));' >> index.html
        echo '            gap: 20px;' >> index.html
        echo '            margin: 25px 0;' >> index.html
        echo '        }' >> index.html
        echo '        .module-card {' >> index.html
        echo '            background: var(--dark-light);' >> index.html
        echo '            border: 1px solid var(--border);' >> index.html
        echo '            border-radius: 12px;' >> index.html
        echo '            padding: 25px;' >> index.html
        echo '            transition: all 0.3s;' >> index.html
        echo '        }' >> index.html
        echo '        .module-card:hover { border-color: var(--blue); transform: translateY(-5px); }' >> index.html
        echo '        .module-header {' >> index.html
        echo '            display: flex;' >> index.html
        echo '            justify-content: space-between;' >> index.html
        echo '            align-items: center;' >> index.html
        echo '            margin-bottom: 15px;' >> index.html
        echo '        }' >> index.html
        echo '        .module-title { color: var(--blue); font-size: 1.3em; }' >> index.html
        echo '        .module-stats {' >> index.html
        echo '            display: flex;' >> index.html
        echo '            gap: 15px;' >> index.html
        echo '            margin-top: 15px;' >> index.html
        echo '        }' >> index.html
        echo '        .stat-badge {' >> index.html
        echo '            background: rgba(46, 164, 79, 0.1);' >> index.html
        echo '            color: var(--primary);' >> index.html
        echo '            padding: 5px 10px;' >> index.html
        echo '            border-radius: 20px;' >> index.html
        echo '            font-size: 0.9em;' >> index.html
        echo '        }' >> index.html
        echo '        .hierarchy {' >> index.html
        echo '            background: var(--dark-light);' >> index.html
        echo '            padding: 25px;' >> index.html
        echo '            border-radius: 12px;' >> index.html
        echo '            margin: 25px 0;' >> index.html
        echo '            font-family: "Monaco", monospace;' >> index.html
        echo '            font-size: 0.95em;' >> index.html
        echo '            line-height: 1.8;' >> index.html
        echo '        }' >> index.html
        echo '        .hierarchy .root { color: var(--primary); font-weight: bold; }' >> index.html
        echo '        .hierarchy .module { color: var(--blue); margin-left: 20px; }' >> index.html
        echo '        .hierarchy .function { color: var(--light); margin-left: 40px; }' >> index.html
        echo '        .hierarchy .component { color: var(--yellow); margin-left: 40px; }' >> index.html
        echo '        .code-block {' >> index.html
        echo '            background: #000;' >> index.html
        echo '            padding: 20px;' >> index.html
        echo '            border-radius: 8px;' >> index.html
        echo '            margin: 20px 0;' >> index.html
        echo '            overflow-x: auto;' >> index.html
        echo '            font-family: "Monaco", monospace;' >> index.html
        echo '            font-size: 0.9em;' >> index.html
        echo '        }' >> index.html
        echo '        .dependencies {' >> index.html
        echo '            background: var(--dark-light);' >> index.html
        echo '            padding: 20px;' >> index.html
        echo '            border-radius: 10px;' >> index.html
        echo '            margin: 20px 0;' >> index.html
        echo '        }' >> index.html
        echo '        @media (max-width: 768px) {' >> index.html
        echo '            .module-grid { grid-template-columns: 1fr; }' >> index.html
        echo '            .nav { flex-direction: column; }' >> index.html
        echo '        }' >> index.html
        echo '    </style>' >> index.html
        echo '</head>' >> index.html
        echo '<body>' >> index.html
        echo '    <div class="container">' >> index.html
        echo '        <header>' >> index.html
        echo '            <h1><i class="fas fa-microscope"></i> AnÃ¡lise Detalhada de Scripts</h1>' >> index.html
        echo '            <p>ImÃ³veis MaceiÃ³ - Balancete do CÃ³digo Fonte</p>' >> index.html
        echo '            <p><strong>Gerado em:</strong> '"$DATE_NOW"'</p>' >> index.html
        echo '            <p><small>AnÃ¡lise hierÃ¡rquica completa dos mÃ³dulos e funÃ§Ãµes</small></p>' >> index.html
        echo '        </header>' >> index.html
        echo '' >> index.html
        echo '        <div class="nav">' >> index.html
        echo '            <a href="#hierarchy"><i class="fas fa-sitemap"></i> Hierarquia</a>' >> index.html
        echo '            <a href="#modules"><i class="fas fa-cubes"></i> MÃ³dulos Detalhados</a>' >> index.html
        echo '            <a href="#dependencies"><i class="fas fa-share-alt"></i> DependÃªncias</a>' >> index.html
        echo '            <a href="#functions"><i class="fas fa-code"></i> FunÃ§Ãµes</a>' >> index.html
        echo '            <a href="https://rclessa25-hub.github.io/imoveis-maceio/" target="_blank">' >> index.html
        echo '                <i class="fas fa-rocket"></i> Site Principal' >> index.html
        echo '            </a>' >> index.html
        echo '        </div>' >> index.html
        echo '' >> index.html
        echo '        <section id="hierarchy">' >> index.html
        echo '            <h2><i class="fas fa-network-wired"></i> Hierarquia Completa dos Scripts</h2>' >> index.html
        echo '            ' >> index.html
        echo '            <div class="hierarchy">' >> index.html
        echo '                <div class="root">ğŸ“¦ RAIZ DO PROJETO (imoveis-maceio)</div>' >> index.html
        echo '                ' >> index.html
        echo '                <div class="module">â”œâ”€â”€ ğŸ¯ <strong>ENTRY POINT</strong></div>' >> index.html
        echo '                <div class="function">â”‚   â””â”€â”€ ğŸ“„ index.html (Ponto de entrada principal)</div>' >> index.html
        echo '                <div class="function">â”‚       â””â”€â”€ ğŸ“„ js/main.js (Inicializador do sistema)</div>' >> index.html
        echo '                ' >> index.html
        echo '                <div class="module">â”œâ”€â”€ ğŸ—ï¸ <strong>CAMADA DE INFRAESTRUTURA</strong></div>' >> index.html
        echo '                <div class="function">â”‚   â””â”€â”€ ğŸ“ js/modules/supabase.js</div>' >> index.html
        echo '                <div class="function">â”‚       â”œâ”€â”€ ğŸ”§ ConfiguraÃ§Ã£o do cliente Supabase</div>' >> index.html
        echo '                <div class="function">â”‚       â”œâ”€â”€ ğŸ” MÃ©todos de autenticaÃ§Ã£o</div>' >> index.html
        echo '                <div class="function">â”‚       â””â”€â”€ ğŸ—„ï¸  ConexÃ£o com banco de dados</div>' >> index.html
        echo '                ' >> index.html
        echo '                <div class="module">â”œâ”€â”€ ğŸ’¼ <strong>CAMADA DE NEGÃ“CIO</strong></div>' >> index.html
        echo '                <div class="function">â”‚   â”œâ”€â”€ ğŸ“ js/modules/properties.js</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚   â”œâ”€â”€ ğŸ  CRUD de imÃ³veis</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚   â”œâ”€â”€ ğŸ” Filtros e busca</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚   â””â”€â”€ ğŸ“Š Listagem e paginaÃ§Ã£o</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚</div>' >> index.html
        echo '                <div class="function">â”‚   â”œâ”€â”€ ğŸ“ js/modules/admin.js</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚   â”œâ”€â”€ ğŸ‘¨â€ğŸ’¼ GestÃ£o de usuÃ¡rios</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚   â”œâ”€â”€ ğŸ“ˆ Dashboard administrativo</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚   â””â”€â”€ âš™ï¸  ConfiguraÃ§Ãµes do sistema</div>' >> index.html
        echo '                <div class="function">â”‚   â”‚</div>' >> index.html
        echo '                <div class="function">â”‚   â””â”€â”€ ğŸ“ js/modules/gallery.js</div>' >> index.html
        echo '                <div class="function">â”‚       â”œâ”€â”€ ğŸ–¼ï¸  Carregamento de imagens</div>' >> index.html
        echo '                <div class="function">â”‚       â”œâ”€â”€ ğŸ” VisualizaÃ§Ã£o em lightbox</div>' >> index.html
        echo '                <div class="function">â”‚       â””â”€â”€ ğŸ“¤ Upload e gerenciamento</div>' >> index.html
        echo '                ' >> index.html
        echo '                <div class="module">â”œâ”€â”€ ğŸ› ï¸ <strong>CAMADA DE UTILITÃRIOS</strong></div>' >> index.html
        echo '                <div class="function">â”‚   â””â”€â”€ ğŸ“ js/modules/utils.js</div>' >> index.html
        echo '                <div class="function">â”‚       â”œâ”€â”€ ğŸ”§ FunÃ§Ãµes auxiliares</div>' >> index.html
        echo '                <div class="function">â”‚       â”œâ”€â”€ âœ… ValidaÃ§Ãµes de formulÃ¡rio</div>' >> index.html
        echo '                <div class="function">â”‚       â””â”€â”€ ğŸ¨ FormataÃ§Ã£o de dados</div>' >> index.html
        echo '                ' >> index.html
        echo '                <div class="module">â”œâ”€â”€ ğŸ¨ <strong>CAMADA DE COMPONENTES UI</strong></div>' >> index.html
        echo '                <div class="component">â”‚   â”œâ”€â”€ ğŸ“ js/components/Header.js</div>' >> index.html
        echo '                <div class="component">â”‚   â”‚   â”œâ”€â”€ ğŸ·ï¸  CabeÃ§alho responsivo</div>' >> index.html
        echo '                <div class="component">â”‚   â”‚   â”œâ”€â”€ ğŸ§­ NavegaÃ§Ã£o principal</div>' >> index.html
        echo '                <div class="component">â”‚   â”‚   â””â”€â”€ ğŸ”˜ Menu mobile</div>' >> index.html
        echo '                <div class="component">â”‚   â”‚</div>' >> index.html
        echo '                <div class="component">â”‚   â””â”€â”€ ğŸ“ js/components/PropertyCard.js</div>' >> index.html
        echo '                <div class="component">â”‚       â”œâ”€â”€ ğŸ¡ Card de imÃ³vel reutilizÃ¡vel</div>' >> index.html
        echo '                <div class="component">â”‚       â”œâ”€â”€ â­ Sistema de favoritos</div>' >> index.html
        echo '                <div class="component">â”‚       â””â”€â”€ ğŸ“± Layout responsivo</div>' >> index.html
        echo '                ' >> index.html
        echo '                <div class="module">â””â”€â”€ ğŸ­ <strong>CAMADA DE APRESENTAÃ‡ÃƒO</strong></div>' >> index.html
        echo '                <div class="function">    â”œâ”€â”€ ğŸ“ css/main.css (Estilos globais)</div>' >> index.html
        echo '                <div class="function">    â”œâ”€â”€ ğŸ“ css/admin.css (Estilos do painel)</div>' >> index.html
        echo '                <div class="function">    â”œâ”€â”€ ğŸ“ css/gallery.css (Estilos da galeria)</div>' >> index.html
        echo '                <div class="function">    â”œâ”€â”€ ğŸ“ css/header.css (Estilos do cabeÃ§alho)</div>' >> index.html
        echo '                <div class="function">    â””â”€â”€ ğŸ“ css/responsive.css (Media queries)</div>' >> index.html
        echo '            </div>' >> index.html
        echo '        </section>' >> index.html
        echo '' >> index.html
        echo '        <section id="modules">' >> index.html
        echo '            <h2><i class="fas fa-layer-group"></i> AnÃ¡lise Detalhada por MÃ³dulo</h2>' >> index.html
        echo '            ' >> index.html
        echo '            <div class="module-grid">' >> index.html
        echo '                <div class="module-card">' >> index.html
        echo '                    <div class="module-header">' >> index.html
        echo '                        <div class="module-title"><i class="fas fa-database"></i> supabase.js</div>' >> index.html
        echo '                        <span class="stat-badge">Infraestrutura</span>' >> index.html
        echo '                    </div>' >> index.html
        echo '                    <p><strong>FunÃ§Ã£o:</strong> ConexÃ£o e configuraÃ§Ã£o do banco de dados</p>' >> index.html
        echo '                    <p><strong>DependÃªncias:</strong> Bibliotecas Supabase</p>' >> index.html
        echo '                    <div class="module-stats">' >> index.html
        echo '                        <span class="stat-badge">~150 linhas</span>' >> index.html
        echo '                        <span class="stat-badge">8 funÃ§Ãµes</span>' >> index.html
                        if [[ "$MODULES_DATA" == *"MODULE_supabase_LINES"* ]]; then
                          SUPABASE_LINES=$(echo "$MODULES_DATA" | grep "MODULE_supabase_LINES" | cut -d= -f2)
                          echo "                        <span class=\"stat-badge\">$SUPABASE_LINES linhas</span>" >> index.html
                        fi
        echo '                    </div>' >> index.html
        echo '                </div>' >> index.html
        echo '' >> index.html
        echo '                <div class="module-card">' >> index.html
        echo '                    <div class="module-header">' >> index.html
        echo '                        <div class="module-title"><i class="fas fa-building"></i> properties.js</div>' >> index.html
        echo '                        <span class="stat-badge">NegÃ³cio</span>' >> index.html
        echo '                    </div>' >> index.html
        echo '                    <p><strong>FunÃ§Ã£o:</strong> GestÃ£o completa de imÃ³veis (CRUD)</p>' >> index.html
        echo '                    <p><strong>DependÃªncias:</strong> supabase.js, PropertyCard.js</p>' >> index.html
        echo '                    <div class="module-stats">' >> index.html
        echo '                        <span class="stat-badge">~300 linhas</span>' >> index.html
        echo '                        <span class="stat-badge">15+ funÃ§Ãµes</span>' >> index.html
                        if [[ "$MODULES_DATA" == *"MODULE_properties_LINES"* ]]; then
                          PROPERTIES_LINES=$(echo "$MODULES_DATA" | grep "MODULE_properties_LINES" | cut -d= -f2)
                          echo "                        <span class=\"stat-badge\">$PROPERTIES_LINES linhas</span>" >> index.html
                        fi
        echo '                    </div>' >> index.html
        echo '                </div>' >> index.html
        echo '' >> index.html
        echo '                <div class="module-card">' >> index.html
        echo '                    <div class="module-header">' >> index.html
        echo '                        <div class="module-title"><i class="fas fa-user-shield"></i> admin.js</div>' >> index.html
        echo '                        <span class="stat-badge">AdministraÃ§Ã£o</span>' >> index.html
        echo '                    </div>' >> index.html
        echo '                    <p><strong>FunÃ§Ã£o:</strong> Painel administrativo completo</p>' >> index.html
        echo '                    <p><strong>DependÃªncias:</strong> supabase.js, utils.js</p>' >> index.html
        echo '                    <div class="module-stats">' >> index.html
        echo '                        <span class="stat-badge">~250 linhas</span>' >> index.html
        echo '                        <span class="stat-badge">12 funÃ§Ãµes</span>' >> index.html
                        if [[ "$MODULES_DATA" == *"MODULE_admin_LINES"* ]]; then
                          ADMIN_LINES=$(echo "$MODULES_DATA" | grep "MODULE_admin_LINES" | cut -d= -f2)
                          echo "                        <span class=\"stat-badge\">$ADMIN_LINES linhas</span>" >> index.html
                        fi
        echo '                    </div>' >> index.html
        echo '                </div>' >> index.html
        echo '' >> index.html
        echo '                <div class="module-card">' >> index.html
        echo '                    <div class="module-header">' >> index.html
        echo '                        <div class="module-title"><i class="fas fa-images"></i> gallery.js</div>' >> index.html
        echo '                        <span class="stat-badge">MÃ­dia</span>' >> index.html
        echo '                    </div>' >> index.html
        echo '                    <p><strong>FunÃ§Ã£o:</strong> Galeria e gerenciamento de imagens</p>' >> index.html
        echo '                    <p><strong>DependÃªncias:</strong> supabase.js, utils.js</p>' >> index.html
        echo '                    <div class="module-stats">' >> index.html
        echo '                        <span class="stat-badge">~200 linhas</span>' >> index.html
        echo '                        <span class="stat-badge">10 funÃ§Ãµes</span>' >> index.html
                        if [[ "$MODULES_DATA" == *"MODULE_gallery_LINES"* ]]; then
                          GALLERY_LINES=$(echo "$MODULES_DATA" | grep "MODULE_gallery_LINES" | cut -d= -f2)
                          echo "                        <span class=\"stat-badge\">$GALLERY_LINES linhas</span>" >> index.html
                        fi
        echo '                    </div>' >> index.html
        echo '                </div>' >> index.html
        echo '' >> index.html
        echo '                <div class="module-card">' >> index.html
        echo '                    <div class="module-header">' >> index.html
        echo '                        <div class="module-title"><i class="fas fa-tools"></i> utils.js</div>' >> index.html
        echo '                        <span class="stat-badge">UtilitÃ¡rios</span>' >> index.html
        echo '                    </div>' >> index.html
        echo '                    <p><strong>FunÃ§Ã£o:</strong> FunÃ§Ãµes auxiliares reutilizÃ¡veis</p>' >> index.html
        echo '                    <p><strong>DependÃªncias:</strong> Nenhuma (independente)</p>' >> index.html
        echo '                    <div class="module-stats">' >> index.html
        echo '                        <span class="stat-badge">~100 linhas</span>' >> index.html
        echo '                        <span class="stat-badge">20+ funÃ§Ãµes</span>' >> index.html
                        if [[ "$MODULES_DATA" == *"MODULE_utils_LINES"* ]]; then
                          UTILS_LINES=$(echo "$MODULES_DATA" | grep "MODULE_utils_LINES" | cut -d= -f2)
                          echo "                        <span class=\"stat-badge\">$UTILS_LINES linhas</span>" >> index.html
                        fi
        echo '                    </div>' >> index.html
        echo '                </div>' >> index.html
        echo '            </div>' >> index.html
        echo '        </section>' >> index.html
        echo '' >> index.html
        echo '        <section id="dependencies">' >> index.html
        echo '            <h2><i class="fas fa-project-diagram"></i> Mapa de DependÃªncias</h2>' >> index.html
        echo '            ' >> index.html
        echo '            <div class="dependencies">' >> index.html
        echo '                <h3>ğŸ“Š Fluxo de ExecuÃ§Ã£o</h3>' >> index.html
        echo '                <pre style="background: #000; padding: 20px; border-radius: 8px; color: #00ff00;">' >> index.html
        echo '1. index.html â†’ Carrega js/main.js' >> index.html
        echo '2. main.js â†’ Importa/Inicializa:' >> index.html
        echo '   â”œâ”€â”€ supabase.js (primeiro - infraestrutura)' >> index.html
        echo '   â”œâ”€â”€ utils.js (segundo - utilitÃ¡rios)' >> index.html
        echo '   â”œâ”€â”€ properties.js (depende de supabase)' >> index.html
        echo '   â”œâ”€â”€ admin.js (depende de supabase e utils)' >> index.html
        echo '   â””â”€â”€ gallery.js (depende de supabase e utils)' >> index.html
        echo '3. Componentes sÃ£o carregados sob demanda:' >> index.html
        echo '   â”œâ”€â”€ Header.js (em todas as pÃ¡ginas)' >> index.html
        echo '   â””â”€â”€ PropertyCard.js (apenas em listagens)' >> index.html
        echo '                </pre>' >> index.html
        echo '            </div>' >> index.html
        echo '        </section>' >> index.html
        echo '' >> index.html
        echo '        <section id="functions">' >> index.html
        echo '            <h2><i class="fas fa-code-branch"></i> CatÃ¡logo de FunÃ§Ãµes</h2>' >> index.html
        echo '            ' >> index.html
        echo '            <div class="code-block">' >> index.html
        echo '                <h3>ğŸ“‹ Principais FunÃ§Ãµes por MÃ³dulo</h3>' >> index.html
        echo '                <pre style="color: #c9d1d9;">' >> index.html
        echo "$FUNCTIONS" >> index.html
        echo '                </pre>' >> index.html
        echo '            </div>' >> index.html
        echo '        </section>' >> index.html
        echo '' >> index.html
        echo '        <section style="background: var(--dark-light); padding: 25px; border-radius: 12px; margin: 40px 0;">' >> index.html
        echo '            <h2><i class="fas fa-balance-scale"></i> Balancete do CÃ³digo Fonte</h2>' >> index.html
        echo '            ' >> index.html
        echo '            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">' >> index.html
        echo '                <div style="background: #000; padding: 20px; border-radius: 8px;">' >> index.html
        echo '                    <h3>ğŸ—ï¸ Ativos (MÃ³dulos Principais)</h3>' >> index.html
        echo '                    <ul style="margin-left: 20px; margin-top: 10px;">' >> index.html
        echo '                        <li>supabase.js - ConexÃ£o com banco</li>' >> index.html
        echo '                        <li>properties.js - GestÃ£o de imÃ³veis</li>' >> index.html
        echo '                        <li>admin.js - Painel administrativo</li>' >> index.html
        echo '                        <li>gallery.js - Galeria de imagens</li>' >> index.html
        echo '                        <li>utils.js - UtilitÃ¡rios</li>' >> index.html
        echo '                    </ul>' >> index.html
        echo '                </div>' >> index.html
        echo '                ' >> index.html
        echo '                <div style="background: #000; padding: 20px; border-radius: 8px;">' >> index.html
        echo '                    <h3>ğŸ§© Passivos (Componentes)</h3>' >> index.html
        echo '                    <ul style="margin-left: 20px; margin-top: 10px;">' >> index.html
        echo '                        <li>Header.js - CabeÃ§alho reutilizÃ¡vel</li>' >> index.html
        echo '                        <li>PropertyCard.js - Card de imÃ³vel</li>' >> index.html
        echo '                    </ul>' >> index.html
        echo '                </div>' >> index.html
        echo '                ' >> index.html
        echo '                <div style="background: #000; padding: 20px; border-radius: 8px;">' >> index.html
        echo '                    <h3>ğŸ“Š PatrimÃ´nio LÃ­quido</h3>' >> index.html
        echo '                    <p><strong>Total estimado:</strong> ~1.100 linhas de cÃ³digo</p>' >> index.html
        echo '                    <p><strong>MÃ³dulos ativos:</strong> 5</p>' >> index.html
        echo '                    <p><strong>Componentes:</strong> 2</p>' >> index.html
        echo '                    <p><strong>Arquivos CSS:</strong> 5</p>' >> index.html
        echo '                </div>' >> index.html
        echo '            </div>' >> index.html
        echo '        </section>' >> index.html
        echo '' >> index.html
        echo '        <footer style="margin-top: 60px; padding-top: 30px; border-top: 2px solid var(--border); text-align: center;">' >> index.html
        echo '            <p><strong>ğŸ”¬ AnÃ¡lise TÃ©cnica Completa do Sistema ImÃ³veis MaceiÃ³</strong></p>' >> index.html
        echo '            <p>DocumentaÃ§Ã£o gerada automaticamente | Ãšltima atualizaÃ§Ã£o: '"$DATE_NOW"'</p>' >> index.html
        echo '            <div style="margin-top: 20px;">' >> index.html
        echo '                <a href="https://rclessa25-hub.github.io/imoveis-maceio/" style="color: var(--primary); margin: 0 15px;">' >> index.html
        echo '                    <i class="fas fa-external-link-alt"></i> Site em ProduÃ§Ã£o' >> index.html
        echo '                </a>' >> index.html
        echo '                <a href="https://github.com/rclessa25-hub/imoveis-maceio" style="color: var(--primary); margin: 0 15px;">' >> index.html
        echo '                    <i class="fab fa-github"></i> CÃ³digo Fonte' >> index.html
        echo '                </a>' >> index.html
        echo '                <a href="https://github.com/rclessa25-hub/reports-wlimoveis/actions" style="color: var(--primary); margin: 0 15px;">' >> index.html
        echo '                    <i class="fas fa-redo"></i> Atualizar AnÃ¡lise' >> index.html
        echo '                </a>' >> index.html
        echo '            </div>' >> index.html
        echo '        </footer>' >> index.html
        echo '    </div>' >> index.html
        echo '' >> index.html
        echo '    <script>' >> index.html
        echo '        // NavegaÃ§Ã£o suave' >> index.html
        echo '        document.querySelectorAll(\'.nav a[href^="#"]\').forEach(anchor => {' >> index.html
        echo '            anchor.addEventListener(\'click\', function(e) {' >> index.html
        echo '                e.preventDefault();' >> index.html
        echo '                const target = document.querySelector(this.getAttribute(\'href\'));' >> index.html
        echo '                if (target) {' >> index.html
        echo '                    window.scrollTo({' >> index.html
        echo '                        top: target.offsetTop - 80,' >> index.html
        echo '                        behavior: \'smooth\'' >> index.html
        echo '                    });' >> index.html
        echo '                }' >> index.html
        echo '            });' >> index.html
        echo '        });' >> index.html
        echo '        ' >> index.html
        echo '        console.log(\'ğŸ”¬ AnÃ¡lise detalhada carregada com sucesso!\');' >> index.html
        echo '    </script>' >> index.html
        echo '</body>' >> index.html
        echo '</html>' >> index.html
        
        echo "âœ… RelatÃ³rio detalhado gerado com sucesso!"
    
    - name: ğŸ“¦ Upload para GitHub Pages
      uses: actions/upload-pages-artifact@v3
      with:
        path: '.'
    
    - name: ğŸš€ Deploy
      uses: actions/deploy-pages@v4
    
    - name: ğŸ‰ Mostrar resultado
      run: |
        echo ""
        echo "ğŸ‰ ANÃLISE DETALHADA PUBLICADA!"
        echo "==============================="
        echo ""
        echo "ğŸŒ ACESSE EM:"
        echo "https://rclessa25-hub.github.io/reports-wlimoveis/"
        echo ""
        echo "ğŸ“Š CONTEÃšDO INCLUÃDO:"
        echo "1. ğŸ”¬ Hierarquia completa dos scripts"
        echo "2. ğŸ—ï¸  AnÃ¡lise por camada (infra, negÃ³cio, UI)"
        echo "3. ğŸ“ˆ EstatÃ­sticas detalhadas por mÃ³dulo"
        echo "4. ğŸ—ºï¸  Mapa de dependÃªncias"
        echo "5. ğŸ“‹ CatÃ¡logo de funÃ§Ãµes"
        echo "6. âš–ï¸  Balancete do cÃ³digo fonte"
