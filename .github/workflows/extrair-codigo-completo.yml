name: üì• Extrair C√≥digo Fonte COMPLETO

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 * * 0'
  push:
    branches: [ main, master ]

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  extract-code-complete:
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    
    steps:
    - name: üì• Checkout
      uses: actions/checkout@v4
    
    - name: üì• Clonar projeto principal COMPLETO
      run: |
        echo "üì• CLONANDO C√ìDIGO FONTE COMPLETO..."
        echo "==================================="
        
        # Clonar o projeto principal com TODOS os arquivos
        git clone --depth 1 https://github.com/rclessa25-hub/imoveis-maceio.git fonte-completo
        
        echo "‚úÖ Projeto clonado com sucesso!"
        echo "üìÅ TOTAL de arquivos encontrados:"
        find fonte-completo -type f \( -name "*.html" -o -name "*.js" -o -name "*.css" -o -name "*.json" -o -name "*.yml" -o -name "*.yaml" -o -name "*.md" \) | wc -l
        echo ""
        echo "üìã LISTA COMPLETA:"
        find fonte-completo -type f \( -name "*.html" -o -name "*.js" -o -name "*.css" -o -name "*.json" -o -name "*.yml" -o -name "*.yaml" -o -name "*.md" \) | sort
    
    - name: üìù Criar relat√≥rio com TODAS as linhas de c√≥digo
      run: |
        echo "üìÑ GERANDO RELAT√ìRIO COMPLETO COM TODAS AS LINHAS..."
        echo "=================================================="
        
        DATE_NOW=$(date '+%d/%m/%Y √†s %H:%M:%S')
        
        # Fun√ß√£o para contar TODAS as linhas
        contar_total_linhas() {
          local total=0
          for file in $(find fonte-completo -type f \( -name "*.html" -o -name "*.js" -o -name "*.css" -o -name "*.json" -o -name "*.yml" -o -name "*.yaml" -o -name "*.md" \)); do
            local lines=$(wc -l < "$file" 2>/dev/null || echo "0")
            total=$((total + lines))
          done
          echo "$total"
        }
        
        # Criar diret√≥rio para relat√≥rio
        mkdir -p relatorio-completo
        
        # Criar √≠ndice principal
        cat > relatorio-completo/index.html << 'EOF'
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üì• C√≥digo Fonte COMPLETO - Im√≥veis Macei√≥</title>
<style>
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #0d1117; color: #c9d1d9; margin: 0; padding: 20px; line-height: 1.6; }
.container { max-width: 1600px; margin: 0 auto; }
header { text-align: center; padding: 40px 0; border-bottom: 4px solid #2ea44f; margin-bottom: 40px; background: linear-gradient(135deg, #0d1117 0%, #161b22 100%); border-radius: 15px; }
h1 { color: #2ea44f; font-size: 3em; margin: 0; text-shadow: 0 2px 10px rgba(46, 164, 79, 0.3); }
h2 { color: #58a6ff; margin: 40px 0 25px; padding-bottom: 10px; border-bottom: 2px solid #30363d; }
h3 { color: #f0f6fc; margin: 25px 0 15px; }
.header-info { color: #8b949e; font-size: 1.1em; margin-top: 15px; }
.badge { display: inline-block; background: #238636; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9em; margin: 0 10px; }
.file-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 20px; margin: 30px 0; }
.file-card { background: #161b22; border: 2px solid #30363d; border-radius: 12px; padding: 25px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); }
.file-card:hover { transform: translateY(-5px); border-color: #2ea44f; box-shadow: 0 8px 25px rgba(46, 164, 79, 0.3); }
.file-card h3 { margin-top: 0; color: #58a6ff; display: flex; align-items: center; gap: 10px; }
.file-card .js { color: #f1e05a; }
.file-card .css { color: #563d7c; }
.file-card .html { color: #e34c26; }
.file-card .json { color: #f1e05a; opacity: 0.9; }
.file-card .yml { color: #cb2431; }
.file-card .md { color: #79b8ff; }
.file-stats { display: flex; gap: 15px; margin-top: 15px; font-size: 0.9em; color: #8b949e; }
.code-viewer { background: #000; border: 2px solid #30363d; border-radius: 12px; margin: 30px 0; overflow: hidden; }
.code-header { background: #161b22; padding: 15px 25px; border-bottom: 2px solid #30363d; display: flex; justify-content: space-between; align-items: center; }
.code-header h3 { margin: 0; }
.code-content { padding: 0; overflow-x: auto; max-height: 800px; overflow-y: auto; }
.code-content pre { margin: 0; padding: 25px; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 0.95em; line-height: 1.5; }
.line-number { color: #6a737d; margin-right: 25px; user-select: none; min-width: 40px; display: inline-block; text-align: right; }
.comment { color: #6a737d; font-style: italic; }
.string { color: #9ecbff; }
.keyword { color: #ff7b72; font-weight: bold; }
.function { color: #d2a8ff; }
.number { color: #79b8ff; }
.operator { color: #f97583; }
a { color: #2ea44f; text-decoration: none; font-weight: 500; }
a:hover { text-decoration: underline; color: #3fb950; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 30px 0; }
.stat-card { background: #161b22; border: 1px solid #30363d; border-radius: 10px; padding: 25px; text-align: center; }
.stat-card h4 { color: #58a6ff; margin-top: 0; }
.stat-number { font-size: 2.5em; font-weight: bold; color: #2ea44f; margin: 10px 0; }
.nav-bar { background: #161b22; padding: 20px; border-radius: 10px; margin: 30px 0; position: sticky; top: 20px; z-index: 100; }
.nav-links { display: flex; gap: 20px; flex-wrap: wrap; }
.nav-links a { background: #21262d; padding: 10px 20px; border-radius: 8px; }
footer { text-align: center; margin-top: 60px; padding-top: 30px; border-top: 2px solid #30363d; color: #8b949e; }
.warning { background: #d29922; color: #0d1117; padding: 15px; border-radius: 8px; margin: 20px 0; text-align: center; font-weight: bold; }
.success { background: #238636; color: white; padding: 15px; border-radius: 8px; margin: 20px 0; text-align: center; font-weight: bold; }
.file-counter { position: fixed; bottom: 20px; right: 20px; background: #161b22; padding: 10px 20px; border-radius: 8px; border: 2px solid #2ea44f; z-index: 1000; }
@media (max-width: 768px) {
  .file-list { grid-template-columns: 1fr; }
  .nav-links { flex-direction: column; }
  .code-content pre { font-size: 0.85em; padding: 15px; }
}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="container">
<header>
<h1><i class="fas fa-code-branch"></i> C√≥digo Fonte COMPLETO</h1>
<p class="header-info">Im√≥veis Macei√≥ - Extra√ß√£o COMPLETA de TODAS as linhas</p>
<div style="margin-top: 20px;">
<span class="badge"><i class="fas fa-database"></i> Backup Completo</span>
<span class="badge"><i class="fas fa-infinity"></i> Sem Limites</span>
<span class="badge"><i class="fas fa-sync-alt"></i> Atualiza√ß√£o Autom√°tica</span>
</div>
<p style="margin-top: 20px;"><strong><i class="fas fa-calendar-alt"></i> Gerado em:</strong> $DATE_NOW</p>
</header>

<div class="success">
<i class="fas fa-check-circle"></i> RELAT√ìRIO COMPLETO - TODAS AS LINHAS EXTRA√çDAS SEM LIMITA√á√ïES
</div>

<div class="nav-bar">
<h3><i class="fas fa-compass"></i> Navega√ß√£o R√°pida</h3>
<div class="nav-links">
<a href="#files-list"><i class="fas fa-list"></i> Lista de Arquivos</a>
<a href="#html-files"><i class="fab fa-html5"></i> HTML Completo</a>
<a href="#js-files"><i class="fab fa-js-square"></i> JavaScript</a>
<a href="#css-files"><i class="fab fa-css3-alt"></i> CSS</a>
<a href="#other-files"><i class="fas fa-file-code"></i> Outros Arquivos</a>
<a href="#stats"><i class="fas fa-chart-bar"></i> Estat√≠sticas</a>
</div>
</div>
EOF

        # Contar arquivos e linhas totais
        echo "Calculando estat√≠sticas completas..."
        TOTAL_FILES=0
        TOTAL_LINES=0
        HTML_COUNT=0
        JS_COUNT=0
        CSS_COUNT=0
        JSON_COUNT=0
        YML_COUNT=0
        MD_COUNT=0
        OTHER_COUNT=0

        # LISTA DE ARQUIVOS - Se√ß√£o 1
        echo '<h2 id="files-list"><i class="fas fa-folder-open"></i> Lista COMPLETA de Arquivos</h2>' >> relatorio-completo/index.html
        echo '<div class="file-list">' >> relatorio-completo/index.html
        
        # Processar TODOS os arquivos
        while IFS= read -r file; do
          if [ -f "$file" ]; then
            TOTAL_FILES=$((TOTAL_FILES + 1))
            filename=$(basename "$file")
            extension="${filename##*.}"
            relative_path=${file#fonte-completo/}
            lines=$(wc -l < "$file" 2>/dev/null || echo "0")
            size=$(wc -c < "$file" 2>/dev/null || echo "0")
            size_kb=$((size / 1024))
            TOTAL_LINES=$((TOTAL_LINES + lines))
            
            case $extension in
              "html")
                class="html"
                icon="<i class='fab fa-html5'></i>"
                HTML_COUNT=$((HTML_COUNT + 1))
                ;;
              "js")
                class="js"
                icon="<i class='fab fa-js-square'></i>"
                JS_COUNT=$((JS_COUNT + 1))
                ;;
              "css")
                class="css"
                icon="<i class='fab fa-css3-alt'></i>"
                CSS_COUNT=$((CSS_COUNT + 1))
                ;;
              "json")
                class="json"
                icon="<i class='fas fa-code'></i>"
                JSON_COUNT=$((JSON_COUNT + 1))
                ;;
              "yml"|"yaml")
                class="yml"
                icon="<i class='fas fa-cog'></i>"
                YML_COUNT=$((YML_COUNT + 1))
                ;;
              "md")
                class="md"
                icon="<i class='fas fa-file-alt'></i>"
                MD_COUNT=$((MD_COUNT + 1))
                ;;
              *)
                class=""
                icon="<i class='fas fa-file'></i>"
                OTHER_COUNT=$((OTHER_COUNT + 1))
                ;;
            esac
            
            # Gerar ID √∫nico para o arquivo
            file_id=$(echo "$relative_path" | sed 's/[^a-zA-Z0-9]/-/g')
            
            # Criar card do arquivo
            cat >> relatorio-completo/index.html << EOF
<div class="file-card">
<h3>$icon <span class="$class">$filename</span></h3>
<p><strong><i class="fas fa-folder"></i> Local:</strong> $(dirname "$relative_path")</p>
<div class="file-stats">
<span><i class="fas fa-bars"></i> $lines linhas</span>
<span><i class="fas fa-weight-hanging"></i> $size_kb KB</span>
<span><i class="fas fa-hashtag"></i> $extension</span>
</div>
<p><a href="#$file_id"><i class="fas fa-eye"></i> Ver c√≥digo COMPLETO ‚Üí</a></p>
</div>
EOF
          fi
        done < <(find fonte-completo -type f \( -name "*.html" -o -name "*.js" -o -name "*.css" -o -name "*.json" -o -name "*.yml" -o -name "*.yaml" -o -name "*.md" -o -name "*.txt" -o -name "*.xml" \) | sort)
        
        echo '</div>' >> relatorio-completo/index.html
        
        # SE√á√ÉO 2: C√ìDIGO COMPLETO HTML
        echo '<h2 id="html-files"><i class="fab fa-html5"></i> Arquivos HTML COMPLETOS</h2>' >> relatorio-completo/index.html
        
        for html_file in fonte-completo/*.html fonte-completo/**/*.html; do
          if [ -f "$html_file" ] && [ "$(basename "$html_file")" != "index.html" ]; then
            filename=$(basename "$html_file")
            relative_path=${html_file#fonte-completo/}
            file_id=$(echo "$relative_path" | sed 's/[^a-zA-Z0-9]/-/g')
            lines=$(wc -l < "$html_file" 2>/dev/null || echo "0")
            
            echo "<div class='code-viewer' id='$file_id'>" >> relatorio-completo/index.html
            echo "<div class='code-header'>" >> relatorio-completo/index.html
            echo "<h3><i class='fab fa-html5'></i> $relative_path ($lines linhas)</h3>" >> relatorio-completo/index.html
            echo "<span class='badge'><i class='fas fa-bars'></i> $lines linhas</span>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "<div class='code-content'>" >> relatorio-completo/index.html
            echo "<pre>" >> relatorio-completo/index.html
            
            # MOSTRAR TODAS AS LINHAS - SEM LIMITE
            cat "$html_file" | cat -n | while read num line; do
              # Escapar HTML
              line_escaped=$(echo "$line" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g; s/"/\&quot;/g; s/'"'"'/\&apos;/g')
              echo "<span class='line-number'>$num</span>$line_escaped<br/>" >> relatorio-completo/index.html
            done
            
            echo "</pre>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
          fi
        done
        
        # SE√á√ÉO 3: JAVASCRIPT COMPLETO
        echo '<h2 id="js-files"><i class="fab fa-js-square"></i> JavaScript COMPLETO</h2>' >> relatorio-completo/index.html
        
        for js_file in fonte-completo/*.js fonte-completo/**/*.js; do
          if [ -f "$js_file" ]; then
            filename=$(basename "$js_file")
            relative_path=${js_file#fonte-completo/}
            file_id=$(echo "$relative_path" | sed 's/[^a-zA-Z0-9]/-/g')
            lines=$(wc -l < "$js_file" 2>/dev/null || echo "0")
            
            echo "<div class='code-viewer' id='$file_id'>" >> relatorio-completo/index.html
            echo "<div class='code-header'>" >> relatorio-completo/index.html
            echo "<h3><i class='fab fa-js-square'></i> $relative_path ($lines linhas)</h3>" >> relatorio-completo/index.html
            echo "<span class='badge'><i class='fas fa-bars'></i> $lines linhas</span>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "<div class='code-content'>" >> relatorio-completo/index.html
            echo "<pre>" >> relatorio-completo/index.html
            
            # MOSTRAR TODAS AS LINHAS - SEM LIMITE
            cat "$js_file" | cat -n | while read num line; do
              # Escapar HTML
              line_escaped=$(echo "$line" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g')
              
              # Destacar sintaxe
              if [[ $line_escaped =~ ^//.* ]]; then
                line_escaped="<span class='comment'>$line_escaped</span>"
              fi
              
              echo "<span class='line-number'>$num</span>$line_escaped<br/>" >> relatorio-completo/index.html
            done
            
            echo "</pre>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
          fi
        done
        
        # SE√á√ÉO 4: CSS COMPLETO
        echo '<h2 id="css-files"><i class="fab fa-css3-alt"></i> CSS COMPLETO</h2>' >> relatorio-completo/index.html
        
        for css_file in fonte-completo/*.css fonte-completo/**/*.css; do
          if [ -f "$css_file" ]; then
            filename=$(basename "$css_file")
            relative_path=${css_file#fonte-completo/}
            file_id=$(echo "$relative_path" | sed 's/[^a-zA-Z0-9]/-/g')
            lines=$(wc -l < "$css_file" 2>/dev/null || echo "0")
            
            echo "<div class='code-viewer' id='$file_id'>" >> relatorio-completo/index.html
            echo "<div class='code-header'>" >> relatorio-completo/index.html
            echo "<h3><i class='fab fa-css3-alt'></i> $relative_path ($lines linhas)</h3>" >> relatorio-completo/index.html
            echo "<span class='badge'><i class='fas fa-bars'></i> $lines linhas</span>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "<div class='code-content'>" >> relatorio-completo/index.html
            echo "<pre>" >> relatorio-completo/index.html
            
            # MOSTRAR TODAS AS LINHAS - SEM LIMITE
            cat "$css_file" | cat -n | while read num line; do
              line_escaped=$(echo "$line" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g')
              echo "<span class='line-number'>$num</span>$line_escaped<br/>" >> relatorio-completo/index.html
            done
            
            echo "</pre>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
          fi
        done
        
        # SE√á√ÉO 5: OUTROS ARQUIVOS
        echo '<h2 id="other-files"><i class="fas fa-file-code"></i> Outros Arquivos</h2>' >> relatorio-completo/index.html
        
        for other_file in fonte-completo/*.json fonte-completo/*.yml fonte-completo/*.yaml fonte-completo/*.md fonte-completo/**/*.json fonte-completo/**/*.yml fonte-completo/**/*.yaml fonte-completo/**/*.md; do
          if [ -f "$other_file" ] && [[ "$other_file" != *"/node_modules/"* ]] && [[ "$other_file" != *"/dist/"* ]] && [[ "$other_file" != *"/.git/"* ]]; then
            filename=$(basename "$other_file")
            relative_path=${other_file#fonte-completo/}
            file_id=$(echo "$relative_path" | sed 's/[^a-zA-Z0-9]/-/g')
            lines=$(wc -l < "$other_file" 2>/dev/null || echo "0")
            extension="${filename##*.}"
            
            case $extension in
              "json") icon="<i class='fas fa-code'></i>" ;;
              "yml"|"yaml") icon="<i class='fas fa-cog'></i>" ;;
              "md") icon="<i class='fas fa-file-alt'></i>" ;;
              *) icon="<i class='fas fa-file'></i>" ;;
            esac
            
            echo "<div class='code-viewer' id='$file_id'>" >> relatorio-completo/index.html
            echo "<div class='code-header'>" >> relatorio-completo/index.html
            echo "<h3>$icon $relative_path ($lines linhas)</h3>" >> relatorio-completo/index.html
            echo "<span class='badge'><i class='fas fa-bars'></i> $lines linhas</span>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "<div class='code-content'>" >> relatorio-completo/index.html
            echo "<pre>" >> relatorio-completo/index.html
            
            # MOSTRAR TODAS AS LINHAS - SEM LIMITE
            cat "$other_file" | cat -n | while read num line; do
              line_escaped=$(echo "$line" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g')
              echo "<span class='line-number'>$num</span>$line_escaped<br/>" >> relatorio-completo/index.html
            done
            
            echo "</pre>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
            echo "</div>" >> relatorio-completo/index.html
          fi
        done
        
        # ESTAT√çSTICAS - Se√ß√£o final
        cat >> relatorio-completo/index.html << EOF
<h2 id="stats"><i class="fas fa-chart-bar"></i> Estat√≠sticas COMPLETAS</h2>

<div class="stats-grid">
<div class="stat-card">
<h4><i class="fas fa-file-code"></i> Total de Arquivos</h4>
<div class="stat-number">$TOTAL_FILES</div>
<p>Todos os arquivos extra√≠dos</p>
</div>

<div class="stat-card">
<h4><i class="fas fa-bars"></i> Total de Linhas</h4>
<div class="stat-number">$TOTAL_LINES</div>
<p>TODAS as linhas sem limita√ß√µes</p>
</div>

<div class="stat-card">
<h4><i class="fab fa-html5"></i> HTML</h4>
<div class="stat-number">$HTML_COUNT</div>
<p>Arquivos HTML</p>
</div>

<div class="stat-card">
<h4><i class="fab fa-js-square"></i> JavaScript</h4>
<div class="stat-number">$JS_COUNT</div>
<p>Arquivos JS</p>
</div>

<div class="stat-card">
<h4><i class="fab fa-css3-alt"></i> CSS</h4>
<div class="stat-number">$CSS_COUNT</div>
<p>Arquivos CSS</p>
</div>

<div class="stat-card">
<h4><i class="fas fa-file-alt"></i> Outros</h4>
<div class="stat-number">$((JSON_COUNT + YML_COUNT + MD_COUNT + OTHER_COUNT))</div>
<p>JSON, YAML, MD, etc.</p>
</div>
</div>

<div class="success" style="margin-top: 40px;">
<i class="fas fa-check-double"></i> EXTRA√á√ÉO 100% COMPLETA - TODAS AS $TOTAL_LINES LINHAS FORAM PROCESSADAS SEM NENHUMA RESTRI√á√ÉO
</div>

<footer>
<h3><i class="fas fa-database"></i> Backup Completo do C√≥digo Fonte</h3>
<p><strong>Gerado automaticamente em:</strong> $DATE_NOW</p>
<p><strong>Status:</strong> <span style="color: #3fb950; font-weight: bold;"><i class="fas fa-check-circle"></i> Completo e Sem Limita√ß√µes</span></p>
<div style="margin-top: 30px; display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
<a href="https://rclessa25-hub.github.io/imoveis-maceio/" style="background: #2ea44f; color: white; padding: 12px 25px; border-radius: 8px; display: inline-flex; align-items: center; gap: 10px;">
<i class="fas fa-external-link-alt"></i> Site Principal
</a>
<a href="https://github.com/rclessa25-hub/imoveis-maceio" style="background: #161b22; color: white; padding: 12px 25px; border-radius: 8px; display: inline-flex; align-items: center; gap: 10px;">
<i class="fab fa-github"></i> Reposit√≥rio Original
</a>
<a href="#files-list" style="background: #1f6feb; color: white; padding: 12px 25px; border-radius: 8px; display: inline-flex; align-items: center; gap: 10px;">
<i class="fas fa-arrow-up"></i> Voltar ao Topo
</a>
</div>
<p style="margin-top: 30px; color: #8b949e; font-size: 0.9em;">
<i class="fas fa-info-circle"></i> Este relat√≥rio cont√©m TODAS as $TOTAL_LINES linhas de c√≥digo sem nenhuma restri√ß√£o de visualiza√ß√£o.
</p>
</footer>

<div class="file-counter">
<i class="fas fa-file-alt"></i> $TOTAL_FILES arquivos | <i class="fas fa-bars"></i> $TOTAL_LINES linhas
</div>
EOF

        # Script para destaque de sintaxe avan√ßado
        cat >> relatorio-completo/index.html << 'EOF'
<script>
// Destacar palavras-chave JavaScript
const jsKeywords = ["function", "const", "let", "var", "class", "import", "export", "async", "await", "return", "if", "else", "for", "while", "try", "catch", "throw", "new", "this", "typeof", "instanceof", "switch", "case", "default", "break", "continue", "do", "finally"];
const htmlKeywords = ["<!DOCTYPE", "<html", "<head", "<body", "<div", "<span", "<p", "<a", "<img", "<script", "<style", "<link", "<meta"];
const cssKeywords = ["@media", "@keyframes", "@import", "@font-face", "margin", "padding", "color", "background", "font-size", "display", "position", "width", "height"];

function highlightSyntax() {
    document.querySelectorAll('.code-viewer pre').forEach(pre => {
        let html = pre.innerHTML;
        
        // Destacar coment√°rios
        html = html.replace(/\/\/.*/g, '<span class="comment">$&</span>');
        html = html.replace(/\/\*[\s\S]*?\*\//g, '<span class="comment">$&</span>');
        
        // Destacar strings
        html = html.replace(/"([^"\\]*(\\.[^"\\]*)*)"/g, '<span class="string">"$1"</span>');
        html = html.replace(/'([^'\\]*(\\.[^'\\]*)*)'/g, "<span class='string'>'$1'</span>");
        
        // Destacar n√∫meros
        html = html.replace(/\b\d+\b/g, '<span class="number">$&</span>');
        
        // Destacar operadores
        html = html.replace(/([=+-\/*<>!&|^~%]+)/g, '<span class="operator">$1</span>');
        
        // Destacar palavras-chave JavaScript
        jsKeywords.forEach(keyword => {
            const regex = new RegExp(`\\b${keyword}\\b`, 'g');
            html = html.replace(regex, `<span class="keyword">${keyword}</span>`);
        });
        
        // Destacar fun√ß√µes
        html = html.replace(/(\w+)\s*\(/g, '<span class="function">$1</span>(');
        
        pre.innerHTML = html;
    });
}

// Aplicar destaque quando a p√°gina carregar
document.addEventListener('DOMContentLoaded', highlightSyntax);

// Adicionar bot√£o para copiar c√≥digo
function addCopyButtons() {
    document.querySelectorAll('.code-viewer').forEach(viewer => {
        const header = viewer.querySelector('.code-header');
        const copyBtn = document.createElement('button');
        copyBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar';
        copyBtn.style.cssText = 'background: #2ea44f; color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-family: inherit;';
        copyBtn.onclick = function() {
            const code = viewer.querySelector('pre').innerText;
            navigator.clipboard.writeText(code).then(() => {
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i> Copiado!';
                copyBtn.style.background = '#238636';
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.style.background = '#2ea44f';
                }, 2000);
            });
        };
        header.appendChild(copyBtn);
    });
}

document.addEventListener('DOMContentLoaded', addCopyButtons);

// Smooth scroll para navega√ß√£o
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement) {
            targetElement.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});
</script>
</div>
</body>
</html>
EOF

        # Mover o index.html para o diret√≥rio raiz
        cp relatorio-completo/index.html index.html
        
        # Criar um arquivo de estat√≠sticas separado
        cat > estatisticas.txt << EOF
=== ESTAT√çSTICAS DA EXTRA√á√ÉO COMPLETA ===
Data: $DATE_NOW
Total de arquivos: $TOTAL_FILES
Total de linhas: $TOTAL_LINES
HTML: $HTML_COUNT arquivos
JavaScript: $JS_COUNT arquivos
CSS: $CSS_COUNT arquivos
JSON: $JSON_COUNT arquivos
YAML/YML: $YML_COUNT arquivos
Markdown: $MD_COUNT arquivos
Outros: $OTHER_COUNT arquivos
=== FIM DAS ESTAT√çSTICAS ===
EOF

        echo ""
        echo "‚úÖ RELAT√ìRIO COMPLETO GERADO COM SUCESSO!"
        echo "=========================================="
        echo ""
        echo "üìä ESTAT√çSTICAS FINAIS:"
        echo "======================="
        echo "üìÅ Total de arquivos: $TOTAL_FILES"
        echo "üìà Total de linhas: $TOTAL_LINES"
        echo "üîπ HTML: $HTML_COUNT arquivos"
        echo "üî∏ JavaScript: $JS_COUNT arquivos"
        echo "üé® CSS: $CSS_COUNT arquivos"
        echo "üìã Outros: $((JSON_COUNT + YML_COUNT + MD_COUNT + OTHER_COUNT)) arquivos"
        echo ""
        echo "üö® IMPORTANTE: TODAS AS $TOTAL_LINES LINHAS FORAM EXTRA√çDAS SEM LIMITA√á√ïES!"
    
    - name: üì¶ Upload para GitHub Pages
      uses: actions/upload-pages-artifact@v3
      with:
        path: '.'
    
    - name: üöÄ Deploy
      id: deployment
      uses: actions/deploy-pages@v4
    
    - name: üéâ Mostrar resultado FINAL
      run: |
        echo ""
        echo "üéâüéâüéâ C√ìDIGO FONTE 100% COMPLETO EXTRA√çDO!"
        echo "=========================================="
        echo ""
        echo "üåê ACESSE O RELAT√ìRIO COMPLETO EM:"
        echo "${{ steps.deployment.outputs.page_url }}"
        echo ""
        echo "üì• AGORA COM TUDO:"
        echo "1. ‚úÖ TODAS as linhas de c√≥digo SEM LIMITA√á√ïES"
        echo "2. üìÑ C√≥digo COMPLETO de todos os arquivos"
        echo "3. üìú M√≥dulos JavaScript 100% extra√≠dos"
        echo "4. üé® CSS completo sem cortes"
        echo "5. üìä Estat√≠sticas reais e precisas"
        echo "6. üîç Visualiza√ß√£o avan√ßada com numera√ß√£o"
        echo "7. üìã Bot√£o de copiar c√≥digo"
        echo "8. üß≠ Navega√ß√£o r√°pida e suave"
        echo "9. üì± Design responsivo"
        echo "10. üéØ Destaque de sintaxe avan√ßado"
        echo ""
        echo "üö® STATUS: EXTRA√á√ÉO 100% COMPLETA - SEM RESTRI√á√ïES!"
