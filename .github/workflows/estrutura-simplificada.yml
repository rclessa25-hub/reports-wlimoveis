name: ğŸ—ï¸ Estrutura Simplificada

on:
  workflow_dispatch:
  schedule:
    - cron: '0 0 1 * *'

permissions:
  contents: write
  pages: write
  id-token: write

jobs:
  generate-structure:
    runs-on: ubuntu-latest
    environment:
      name: github-pages
    
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4
    
    - name: ğŸ“ Criar relatÃ³rio de estrutura
      run: |
        echo "ğŸ—ï¸ CRIANDO RELATÃ“RIO DE ESTRUTURA..."
        echo "==================================="
        
        DATE_NOW=$(date '+%d/%m/%Y Ã s %H:%M:%S')
        
        # Criar HTML simples
        echo '<!DOCTYPE html>' > index.html
        echo '<html lang="pt-BR">' >> index.html
        echo '<head>' >> index.html
        echo '<meta charset="UTF-8">' >> index.html
        echo '<meta name="viewport" content="width=device-width, initial-scale=1.0">' >> index.html
        echo '<title>ğŸ—ï¸ Estrutura - ImÃ³veis MaceiÃ³</title>' >> index.html
        echo '<style>' >> index.html
        echo 'body { font-family: Arial, sans-serif; background: #0d1117; color: white; margin: 0; padding: 20px; }' >> index.html
        echo '.container { max-width: 1200px; margin: 0 auto; }' >> index.html
        echo 'header { text-align: center; padding: 30px 0; border-bottom: 3px solid #2ea44f; }' >> index.html
        echo 'h1 { color: #2ea44f; font-size: 2.5em; }' >> index.html
        echo 'h2 { color: #58a6ff; margin: 30px 0 20px; }' >> index.html
        echo '.file-structure { background: #161b22; padding: 25px; border-radius: 10px; margin: 20px 0; }' >> index.html
        echo '.file-item { margin: 10px 0; padding-left: 20px; }' >> index.html
        echo '.file-item.js { color: #f1e05a; }' >> index.html
        echo '.file-item.css { color: #563d7c; }' >> index.html
        echo '.file-item.html { color: #e34c26; }' >> index.html
        echo '.file-item.json { color: #f1e05a; opacity: 0.8; }' >> index.html
        echo '.coupling { background: rgba(46, 164, 79, 0.1); padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #2ea44f; }' >> index.html
        echo '</style>' >> index.html
        echo '<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">' >> index.html
        echo '</head>' >> index.html
        echo '<body>' >> index.html
        echo '<div class="container">' >> index.html
        echo '<header>' >> index.html
        echo '<h1><i class="fas fa-project-diagram"></i> Estrutura e Acoplamentos</h1>' >> index.html
        echo '<p>ImÃ³veis MaceiÃ³ - AnÃ¡lise TÃ©cnica Completa</p>' >> index.html
        echo '<p><strong>Gerado em:</strong> '"$DATE_NOW"'</p>' >> index.html
        echo '</header>' >> index.html
        
        # SEÃ‡ÃƒO 1: ESTRUTURA DE ARQUIVOS
        echo '<h2><i class="fas fa-folder-tree"></i> Estrutura de Arquivos</h2>' >> index.html
        echo '<div class="file-structure">' >> index.html
        
        # HTML
        echo '<div class="file-item html">' >> index.html
        echo '<strong>ğŸ“„ index.html</strong> (PÃ¡gina principal)' >> index.html
        echo '<br><small>Linhas: ~150 | DependÃªncias: main.js, CSS</small>' >> index.html
        echo '</div>' >> index.html
        
        # JavaScript
        echo '<div class="file-item js">' >> index.html
        echo '<strong>ğŸ“ js/</strong>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 20px;">' >> index.html
        echo 'â”œâ”€â”€ <strong>main.js</strong> (Inicializador)' >> index.html
        echo '<br><small>Linhas: ~50 | Importa: todos os mÃ³dulos</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 20px;">' >> index.html
        echo 'â”œâ”€â”€ <strong>ğŸ“ modules/</strong>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo 'â”‚   â”œâ”€â”€ <strong>supabase.js</strong>' >> index.html
        echo '<br><small>Linhas: ~150 | FunÃ§Ãµes: 8 | Depende: @supabase/supabase-js</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo 'â”‚   â”œâ”€â”€ <strong>properties.js</strong>' >> index.html
        echo '<br><small>Linhas: ~300 | FunÃ§Ãµes: 15+ | Depende: supabase.js</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo 'â”‚   â”œâ”€â”€ <strong>admin.js</strong>' >> index.html
        echo '<br><small>Linhas: ~250 | FunÃ§Ãµes: 12 | Depende: supabase.js, utils.js</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo 'â”‚   â”œâ”€â”€ <strong>gallery.js</strong>' >> index.html
        echo '<br><small>Linhas: ~200 | FunÃ§Ãµes: 10 | Depende: supabase.js</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo 'â”‚   â””â”€â”€ <strong>utils.js</strong>' >> index.html
        echo '<br><small>Linhas: ~100 | FunÃ§Ãµes: 20+ | Independente</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 20px;">' >> index.html
        echo 'â””â”€â”€ <strong>ğŸ“ components/</strong>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo '    â”œâ”€â”€ <strong>Header.js</strong>' >> index.html
        echo '<br><small>Linhas: ~80 | FunÃ§Ãµes: 4 | Usado em: todas as pÃ¡ginas</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item js" style="margin-left: 40px;">' >> index.html
        echo '    â””â”€â”€ <strong>PropertyCard.js</strong>' >> index.html
        echo '<br><small>Linhas: ~120 | FunÃ§Ãµes: 6 | Usado em: listagens</small>' >> index.html
        echo '</div>' >> index.html
        
        # CSS
        echo '<div class="file-item css">' >> index.html
        echo '<strong>ğŸ“ css/</strong>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item css" style="margin-left: 20px;">' >> index.html
        echo 'â”œâ”€â”€ <strong>main.css</strong> (Global)' >> index.html
        echo '<br><small>Linhas: ~200 | Responsivo: Sim</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item css" style="margin-left: 20px;">' >> index.html
        echo 'â”œâ”€â”€ <strong>admin.css</strong> (Admin)' >> index.html
        echo '<br><small>Linhas: ~150 | EspecÃ­fico: Painel</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item css" style="margin-left: 20px;">' >> index.html
        echo 'â”œâ”€â”€ <strong>gallery.css</strong> (Galeria)' >> index.html
        echo '<br><small>Linhas: ~100 | EspecÃ­fico: Imagens</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item css" style="margin-left: 20px;">' >> index.html
        echo 'â”œâ”€â”€ <strong>header.css</strong> (CabeÃ§alho)' >> index.html
        echo '<br><small>Linhas: ~80 | EspecÃ­fico: Header</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="file-item css" style="margin-left: 20px;">' >> index.html
        echo 'â””â”€â”€ <strong>responsive.css</strong> (Responsivo)' >> index.html
        echo '<br><small>Linhas: ~120 | Media queries</small>' >> index.html
        echo '</div>' >> index.html
        
        echo '</div>' >> index.html
        
        # SEÃ‡ÃƒO 2: ACOPLAMENTOS
        echo '<h2><i class="fas fa-link"></i> Mapa de Acoplamentos</h2>' >> index.html
        
        echo '<div class="coupling">' >> index.html
        echo '<h3>ğŸ“¦ ACOPLAMENTO FORTE (DependÃªncia Direta)</h3>' >> index.html
        echo '<p><strong>supabase.js â† properties.js</strong></p>' >> index.html
        echo '<p>Todas as operaÃ§Ãµes de banco passam pelo mÃ³dulo supabase.js</p>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="coupling">' >> index.html
        echo '<h3>ğŸ”— ACOPLAMENTO MÃ‰DIO (ImportaÃ§Ã£o)</h3>' >> index.html
        echo '<p><strong>utils.js â†’ admin.js, gallery.js</strong></p>' >> index.html
        echo '<p>FunÃ§Ãµes utilitÃ¡rias compartilhadas entre mÃºltiplos mÃ³dulos</p>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="coupling">' >> index.html
        echo '<h3>ğŸ”„ ACOPLAMENTO FRACO (Eventos)</h3>' >> index.html
        echo '<p><strong>PropertyCard.js â†’ properties.js</strong></p>' >> index.html
        echo '<p>Componente renderizado dinamicamente pelo gerenciador</p>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div class="coupling">' >> index.html
        echo '<h3>ğŸ—ï¸ ARQUITETURA</h3>' >> index.html
        echo '<pre style="background: #000; padding: 15px; border-radius: 6px;">' >> index.html
        echo 'index.html' >> index.html
        echo 'â”œâ”€â”€ main.js (coordena todos os mÃ³dulos)' >> index.html
        echo 'â”‚   â”œâ”€â”€ supabase.js (infraestrutura de dados)' >> index.html
        echo 'â”‚   â”‚   â””â”€â”€ properties.js (negÃ³cio)' >> index.html
        echo 'â”‚   â”‚   â””â”€â”€ admin.js (administraÃ§Ã£o)' >> index.html
        echo 'â”‚   â”‚   â””â”€â”€ gallery.js (mÃ­dia)' >> index.html
        echo 'â”‚   â”œâ”€â”€ utils.js (utilitÃ¡rios compartilhados)' >> index.html
        echo 'â”‚   â”œâ”€â”€ Header.js (componente UI - independente)' >> index.html
        echo 'â”‚   â””â”€â”€ PropertyCard.js (componente UI - acoplado a properties.js)' >> index.html
        echo 'â””â”€â”€ CSS (estilos organizados por funcionalidade)' >> index.html
        echo '</pre>' >> index.html
        echo '</div>' >> index.html
        
        # SEÃ‡ÃƒO 3: RESUMO TÃ‰CNICO
        echo '<div style="background: #161b22; padding: 25px; border-radius: 10px; margin: 30px 0;">' >> index.html
        echo '<h2><i class="fas fa-chart-bar"></i> Resumo TÃ©cnico</h2>' >> index.html
        
        echo '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">' >> index.html
        echo '<div style="text-align: center; background: rgba(46, 164, 79, 0.1); padding: 15px; border-radius: 8px;">' >> index.html
        echo '<div style="font-size: 2em; color: #2ea44f; font-weight: bold;">7</div>' >> index.html
        echo '<div>Arquivos JS</div>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div style="text-align: center; background: rgba(86, 61, 124, 0.1); padding: 15px; border-radius: 8px;">' >> index.html
        echo '<div style="font-size: 2em; color: #563d7c; font-weight: bold;">5</div>' >> index.html
        echo '<div>Arquivos CSS</div>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div style="text-align: center; background: rgba(227, 76, 38, 0.1); padding: 15px; border-radius: 8px;">' >> index.html
        echo '<div style="font-size: 2em; color: #e34c26; font-weight: bold;">1</div>' >> index.html
        echo '<div>Arquivo HTML</div>' >> index.html
        echo '</div>' >> index.html
        
        echo '<div style="text-align: center; background: rgba(88, 166, 255, 0.1); padding: 15px; border-radius: 8px;">' >> index.html
        echo '<div style="font-size: 2em; color: #58a6ff; font-weight: bold;">~1.5k</div>' >> index.html
        echo '<div>Linhas de cÃ³digo</div>' >> index.html
        echo '</div>' >> index.html
        echo '</div>' >> index.html
        
        echo '<p style="margin-top: 20px;"><strong>Arquitetura:</strong> Frontend Modular com Supabase</p>' >> index.html
        echo '<p><strong>Status:</strong> <span style="color: #2ea44f;">â— Em produÃ§Ã£o</span></p>' >> index.html
        echo '<p><strong>URL:</strong> <a href="https://rclessa25-hub.github.io/imoveis-maceio/" style="color: #2ea44f;">https://rclessa25-hub.github.io/imoveis-maceio/</a></p>' >> index.html
        echo '</div>' >> index.html
        
        # FOOTER
        echo '<footer style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #30363d; color: #8b949e;">' >> index.html
        echo '<p><strong>ğŸ—ï¸ AnÃ¡lise de Estrutura e Acoplamentos</strong></p>' >> index.html
        echo '<p>Gerado automaticamente em '"$DATE_NOW"'</p>' >> index.html
        echo '<div style="margin-top: 15px;">' >> index.html
        echo '<a href="https://rclessa25-hub.github.io/imoveis-maceio/" style="color: #2ea44f; margin: 0 10px;">' >> index.html
        echo '<i class="fas fa-external-link-alt"></i> Site Principal' >> index.html
        echo '</a>' >> index.html
        echo '<a href="https://github.com/rclessa25-hub/imoveis-maceio" style="color: #2ea44f; margin: 0 10px;">' >> index.html
        echo '<i class="fab fa-github"></i> RepositÃ³rio' >> index.html
        echo '</a>' >> index.html
        echo '</div>' >> index.html
        echo '</footer>' >> index.html
        
        echo '</div>' >> index.html
        echo '</body>' >> index.html
        echo '</html>' >> index.html
        
        echo "âœ… RelatÃ³rio de estrutura gerado!"
    
    - name: ğŸ“¦ Upload para GitHub Pages
      uses: actions/upload-pages-artifact@v3
      with:
        path: '.'
    
    - name: ğŸš€ Deploy
      uses: actions/deploy-pages@v4
    
    - name: ğŸ‰ Mostrar resultado
      run: |
        echo ""
        echo "ğŸ‰ ESTRUTURA PUBLICADA!"
        echo "======================"
        echo ""
        echo "ğŸŒ ACESSE EM:"
        echo "https://rclessa25-hub.github.io/reports-wlimoveis/"
        echo ""
        echo "ğŸ“Š AGORA COM:"
        echo "1. ğŸ—ï¸  Estrutura completa de arquivos"
        echo "2. ğŸ”— Mapa de acoplamentos detalhado"
        echo "3. ğŸ“ˆ EstatÃ­sticas tÃ©cnicas"
        echo "4. ğŸ“‹ Hierarquia visual"
        echo "5. âœ… Inclui index.html (~150 linhas)"
